<div style='width: 100%; '>
 <div id="map" style='width: 100%; height: 400px;'></div>
</div>
<table class='table table-hover'>
<thead>
    <tr class='table-info'>
      <th>Name</th>
      <th>Description</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @institutions.each do |institution| %>
      <tr>
        <td><%= institution.name %></td>
        <td><%= institution.address %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<script>

handler = Gmaps.build('Google');
handler.buildMap({
     provider: {}, internal: {id: 'map'}}, function(){
 markers = handler.addMarkers(<%=raw @hash.to_json %>);
     });

navigator.geolocation.getCurrentPosition(setPosition);
function setPosition(position) {
        handler.getMap().setCenter({lat:position.coords.latitude, lng:position.coords.longitude});
        var image = {
          url: 'https://img.icons8.com/color/2x/heart-health.png',
          size: new google.maps.Size(70, 70),
          scaledSize: new google.maps.Size(50, 50)
        };
        var myLatlng = new google.maps.LatLng({lat:position.coords.latitude, lng:position.coords.longitude});
        var marker = new google.maps.Marker({
        position: myLatlng,
        map: handler.getMap(),
        title:"Hello World!",
        icon: image
    });
    handler.getMap().setZoom(11);
        marker.setAnimation(google.maps.Animation.BOUNCE);

        }
</script>





<%# <script>
$(document).ready(function(){
var x = document.getElementById('map');

if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(getAddress);
} else {
    x.innerHTML = "Geolocation is not supported by this browser.";
}
function getAddress(position) {
    var latitude = position.coords.latitude;
    var longitude = position.coords.longitude;
    $.ajax({
        url: '/locations/find_address',
        type: 'GET',
        dataType: 'json',
        data: {latitude: latitude, longitude: longitude}
    })
    .done(function(data) {
        x.innerHTML = data.address;
    });
};
});

</script> %>